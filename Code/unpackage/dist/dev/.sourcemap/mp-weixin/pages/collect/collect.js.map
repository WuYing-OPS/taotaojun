{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/12770/Documents/HBuilderProjects/TTJ/pages/collect/collect.vue?5747","webpack:///C:/Users/12770/Documents/HBuilderProjects/TTJ/pages/collect/collect.vue?fa77","webpack:///C:/Users/12770/Documents/HBuilderProjects/TTJ/pages/collect/collect.vue?71cf","webpack:///C:/Users/12770/Documents/HBuilderProjects/TTJ/pages/collect/collect.vue?cf48","uni-app:///pages/collect/collect.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,kG;AACAA,UAAU,CAACC,gBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAoH;AACpH;AAC2D;AACL;;;AAGtD;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,kFAAM;AACR,EAAE,2FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,sFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAimB,CAAgB,2nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACwCrnB;AACA,MADA,kBACA;AACA;AACA,wBADA;AAEA,6BAFA,EAEA;AACA,mBAHA;AAIA,uBAJA,CAIA;AAJA;AAMA,GARA;AASA;AACA;AACA,cAFA,sBAEA,OAFA,EAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAlBA;AAmBA;AACA,cApBA,sBAoBA,IApBA,EAoBA;AACA;AACA,gFADA;;AAGA,KAxBA;AAyBA;AACA,cA1BA,sBA0BA,OA1BA,EA0BA;AACA;AACA;AACA;AACA,qBADA;AAEA,eAFA,mBAEA,OAFA,EAEA;AACA;AACA,8BADA;AAEA,mBAFA,mBAEA,GAFA,EAEA;AACA;AACA;AACA,iCADA;AAEA,4BAFA;;AAIA;AACA,yCADA;AAEA;AACA,oCADA;AAEA,4CAFA,EAFA;;AAMA,oBANA,CAMA;AACA;AACA;AACA;AACA,2CADA;AAEA;AACA,0CADA,EAFA;;AAKA,sBALA,CAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDADA;AAEA;AACA,0DADA;AAEA;AACA,0DADA,EAFA;;AAKA,sCALA,CAKA;AACA;AACA;AACA;AACA;AACA,mCAVA,CAFA;;AAcA,mBA7BA;AA8BA,iBAvCA;AAwCA;AACA,aAjDA;;AAmDA,SAtDA;;AAwDA,KArFA;AAsFA;AACA,gBAvFA,wBAuFA,CAvFA,EAuFA;AACA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KA9FA;AA+FA,SA/FA,mBA+FA;AACA;AACA,oBADA;AAEA,qBAFA;;AAIA,KApGA,EATA;;AA+GA,QA/GA,oBA+GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KARA;AASA;AACA;AACA;AACA;AACA;AACA,OAJA;AAKA,KANA;AAOA;AACA;AACA;AACA;AACA;AACA,OAJA;AAKA,KANA;AAOA,GAvIA;AAwIA,UAxIA,sBAwIA;AACA;AACA;AACA;AACA,GA5IA,E","file":"pages/collect/collect.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/collect/collect.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./collect.vue?vue&type=template&id=6cfe335c&\"\nvar renderjs\nimport script from \"./collect.vue?vue&type=script&lang=js&\"\nexport * from \"./collect.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/collect/collect.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./collect.vue?vue&type=template&id=6cfe335c&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./collect.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./collect.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<view class=\"cu-custom \">\r\n\t\t\t<cu-custom :isBack=\"true\" bgColor=\"bg-gradual-orange\">\r\n\t\t\t\t<block slot=\"backText\">返回</block>\r\n\t\t\t\t<block slot=\"content\">收藏</block>\r\n\t\t\t</cu-custom>\r\n\t\t</view>\r\n\t\t<view class=\"cu-list menu-avatar comment solids-top\">\r\n\t\t\t<view class=\"cu-item\" v-for=\"(item,index) in saveStoreList\" :key=\"item._id\" @click=\"goToDetail(item)\">\r\n\t\t\t\t<view class=\"cu-avatar round\" :style=\"{backgroundImage:`url(${item.avatarUrl})`}\"></view>\r\n\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t<view class=\"text-grey\">{{item.nickName}}</view>\r\n\t\t\t\t\t<view class=\"text-gray text-content text-df\">\r\n\t\t\t\t\t\t{{item.title}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"bg-grey padding-sm radius margin-top-sm  text-sm\">\r\n\t\t\t\t\t\t<view class=\"flex\">\r\n\t\t\t\t\t\t\t<view class=\"flex-sub\">{{item.description}}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"margin-top-sm flex justify-between\">\r\n\t\t\t\t\t\t<view class=\"text-gray text-df\">{{item.ctime}}</view>\r\n\t\t\t\t\t\t<view @click.stop=\"deleteSave(item._id)\">\r\n\t\t\t\t\t\t\t<text class=\"text-orange\">取消收藏</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<l-loadmore :show=\"loadmoreShow\" :type=\"loadmoretype\" loading-text=\"努力加载中~\" />\r\n\t\t<view class=\"cu-load  over\" v-if=\"!loadmoreShow\"></view>\r\n\t\t<view class='goTop' @click=\"goTop\">\r\n\t\t\t<image src='https://vkceyugu.cdn.bspapp.com/VKCEYUGU-aliyun-l5j2urmfatyb41ea37/580b4200-2728-11eb-b680-7980c8a877b8.png'\r\n\t\t\t v-if=\"!showTop\"></image>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tloadmoreShow: true,\r\n\t\t\t\tloadmoretype: 'loading', //end 我是有底线的\r\n\t\t\t\tshowTop: true,\r\n\t\t\t\tsaveStoreList: '', //收藏的所有商品列表\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 对获取到的数据进行时间的处理\r\n\t\t\thandleTime(context) {\r\n\t\t\t\tfunction getTime(shijianchuo) {\r\n\t\t\t\t\tlet time = new Date(shijianchuo)\r\n\t\t\t\t\tconst y = time.getFullYear();\r\n\t\t\t\t\tconst m = time.getMonth() + 1;\r\n\t\t\t\t\tconst d = time.getDate();\r\n\t\t\t\t\tconst h = time.getHours();\r\n\t\t\t\t\tconst mm = time.getMinutes();\r\n\t\t\t\t\tconst s = time.getSeconds();\r\n\t\t\t\t\treturn y + '-' + m + '-' + d + ' ' + h + ':' + m + ':' + s;\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i = 0; i < context.length; i++) {\r\n\t\t\t\t\tlet newTime = getTime(context[i].ctime)\r\n\t\t\t\t\tcontext[i].ctime = newTime\r\n\t\t\t\t}\r\n\t\t\t\tthis.saveStoreList = context\r\n\t\t\t},\r\n\t\t\t// 跳转详情页\r\n\t\t\tgoToDetail(item) {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '../detail/detail?data=' + encodeURIComponent(JSON.stringify(item))\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 取消收藏哦\r\n\t\t\tdeleteSave(storeid) {\r\n\t\t\t\tconsole.log(storeid)\r\n\t\t\t\tconst that = this\r\n\t\t\t\tuni.getStorage({\r\n\t\t\t\t\tkey: 'openid',\r\n\t\t\t\t\tsuccess(Mopenid) {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: '确定取消收藏吗',\r\n\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\t\t\t\ttitle: \"取消中...\",\r\n\t\t\t\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tuniCloud.callFunction({\r\n\t\t\t\t\t\t\t\t\t\tname: 'deleteStoreSave',\r\n\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\tstoreId: storeid,\r\n\t\t\t\t\t\t\t\t\t\t\tuserOpenid: Mopenid.data\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}).then(res => {\r\n\t\t\t\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"删除\", res)\r\n\t\t\t\t\t\t\t\t\t\tuniCloud.callFunction({\r\n\t\t\t\t\t\t\t\t\t\t\tname: 'getAllStoreSave',\r\n\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\topenid: Mopenid.data\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}).then(res => {\r\n\t\t\t\t\t\t\t\t\t\t\tlet store = []\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"收藏的商品\", res)\r\n\t\t\t\t\t\t\t\t\t\t\tif(res.result.data.length===0){\r\n\t\t\t\t\t\t\t\t\t\t\t\tthat.saveStoreList = \"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tthat.loadmoretype=\"end\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tthat.loadmoreShow =false\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t// 获取到收藏的总数\r\n\t\t\t\t\t\t\t\t\t\t\tuni.$emit('changeSaveCount', res.result.data.length)\r\n\t\t\t\t\t\t\t\t\t\t\tres.result.data.forEach(async (el, index) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(el.storeId)\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait uniCloud.callFunction({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: 'getStoreDetail',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstore_id: el.storeId\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}).then(RES => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstore.push(RES.result.data[0])\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (store.length === res.result.data.length) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthat.handleTime(store)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 点击回到顶部\r\n\t\t\tonPageScroll(e) {\r\n\t\t\t\t// this.scrollTop = e.scrollTop\r\n\t\t\t\tif (e.scrollTop > 500) {\r\n\t\t\t\t\tthis.showTop = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.showTop = true;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgoTop() {\r\n\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\tscrollTop: 0,\r\n\t\t\t\t\tduration: 300\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tuni.$on('getAllSave', data => {\r\n\t\t\t\tconsole.log(\"data\",data)\r\n\t\t\t\tif(data==\"\"){\r\n\t\t\t\t\tthis.saveStoreList = []\r\n\t\t\t\t\tthis.loadmoreShow=false\r\n\t\t\t\t}\r\n\t\t\t\tthis.handleTime(data)\r\n\t\t\t\tthis.loadmoretype = 'end'\r\n\t\t\t})\r\n\t\t\tuni.$on('changeViews', data => {\r\n\t\t\t\tthis.saveStoreList.forEach(item => {\r\n\t\t\t\t\tif (item._id === data.storeId) {\r\n\t\t\t\t\t\titem.views = data.views\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\tuni.$on('changeComemntCount', data => {\r\n\t\t\t\tthis.saveStoreList.forEach(item => {\r\n\t\t\t\t\tif (item._id === data.storeId) {\r\n\t\t\t\t\t\titem.commentsCount = data.Count\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tuni.$off('getAllSave')\r\n\t\t\tuni.$off('changeViews')\r\n\t\t\tuni.$off('changeComemntCount')\r\n\t\t},\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n</style>\n"],"sourceRoot":""}